# How To Set and Run Next.js App

# `Next.js` vs. `create-react-app` Toolchains

- `create-react-app` does not easily help with generating server-side rendered apps.
- `Next.js` comes with speed, and SEO.

# Setup

## Step #1: Run `npx create-next-app@latest <app-name>`

- Run the latest version of `Next.js` by:

  ```sh
      npx create-next-app@latest next.js-test-app
  ```

- Run a specific version of `Next.js` by:

  ```sh
     npx create-next-app@14.1.4 next.js-test-app
  ```

- This step should generate the below **folder Structure**:

  - `node_modules/`
  - `public/`: For static assets to be served
  - `src/app/`: for App router. It has the following files:
    - `src/app/favicon.ico`
    - `src/app/globals.css`
    - `src/app/layout.js`
    - `src/app/page.js`
    - `src/app/page.module.css`
  - `package.json` Project dependencies and scripts
  - `jsconfig.json` Configuration file for JavaScript
  - `.gitignore` Git files and folders to ignore
  - `package-lock.json`
  - `.estlintrc.json` Configuration file for ESLint

- **Remarks**:

  - The `app/` directory in `Next.js` comes with a lot of **features** such as:
    - Layout
    - Routing
    - Fonts usage
    - Loading Component
    - Error Component
    - Not Found Component
    - Template Component
    - Server Component
  - with `Next.js` 13, the file-based routing can be done from the `src/app` folder. Previously, the routing was done from the `pages/` folder instead.
  - To setup pages and routing from the `src/app` folder, we add a setting within the `next.config.js` file as follows:

    ```js
    /** @type {import('next').NextConfig} */
    const nextConfig = {
      experimental: {
        appDir: true,
      },
      reactStrictMode: true,
    };

    module.exports = nextConfig;
    ```

## Step #2: Running Development Server

- To confirm everything works, you can view your app by running `npm run dev` inside your terminal and navigating to [localhost:3000](http://localhost:3000/) in the browser. Then, make a small change to the code and save it.

  ```bash
    npm run dev
    # or
    yarn dev
    # or
    pnpm dev
    # or
    bun dev
  ```

- Remarks:
  - We can change the default port of `Next.js` App from `3000` to any other port by modfying the `package.json` File to add `-p <port_number>` flag. Example:
    ```json
      "scripts": {
      //...
      "dev": "next dev -p 3002",
      "start": "next start -p 3002",
      },
    ```

# Bonus

## Step #: Deploy Next.js App

- The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

## Step #: Set Up Speed Insights

- To start collecting **performance insights**, run the following command
  ```sh
    npm i @vercel/speed-insights
  ```
- Import and use the `<SpeedInsights/>` Next.js component into your app's `layout.js` file.
  ```js
  import { SpeedInsights } from "@vercel/speed-insights/next";
  export default function RootLayout({
    children,
  }: {
    children: React.ReactNode,
  }) {
    return (
      <html lang="en">
        <head>
          <title>Next.js</title>
        </head>
        <body>
          {children}
          <SpeedInsights />
        </body>
      </html>
    );
  }
  ```
- Deploy your changes and visit the deployment to collect your first data points. If you don't see data after a 30 seconds, please check for content blockers and try to navigate between pages on your site.

## Step #: Set Up Web Analytics

- To start counting visitors and page views, follow these steps.
- Step #1: Start by installing `@vercel/analytics` in your existing project.
  ```sh
    npm i @vercel/analytics
  ```
  - The Analytics component is a wrapper around the tracking script, offering more seamless integration with Next.js.
- Step #2: Add the React component

  - Import and use the `<Analytics/>` React component into your app's layout.

    ```js
    import { Trirong } from "next/font/google";
    import { SpeedInsights } from "@vercel/speed-insights/next";
    import { Analytics } from "@vercel/analytics/react";

    const trirong = Trirong({ subsets: ["latin"], weight: ["400"] });

    export const metadata = {
      title: "Create Next App",
      description: "Generated by create next app",
    };

    export default function RootLayout({ children }) {
      return (
        <html lang="en">
          <body className={trirong.className}>
            {children}
            <SpeedInsights />
            <Analytics />
          </body>
        </html>
      );
    }
    ```

- Deploy your changes and visit the deployment to collect your page views.

# Resources and Further Reading

1. [the Next.js GitHub repository](https://github.com/vercel/next.js/)
2. [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.
3. [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
4. [Next.js deployment documentation](https://nextjs.org/docs/deployment)
5. [Add the `SpeedInsights` component to your app](https://vercel.com/docs/speed-insights/quickstart#add-the-speedinsights-component-to-your-app)
